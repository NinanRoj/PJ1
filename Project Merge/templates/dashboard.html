<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', path='css/dashboard.css') }}?v=9">
</head>
<body>
  <!-- Topbar -->
  <header class="topbar">
    <div class="topbar__left"></div>
    <div class="topbar__right">
      <span class="user-name">NA</span>
      <span class="user-avatar" aria-hidden="true"></span>
    </div>
  </header>

  <!-- Sidebar -->
  <aside class="sidebar">
    <nav class="nav">
      <a class="nav__item nav__item--active" href="#">Upload PDF</a>
      <a class="nav__item" href="#">Similarity History</a>
      <a class="nav__item" href="#">Settings</a>
    </nav>
  </aside>

  <main class="content">
    <!-- FABs (ซ่อนตอนยังไม่มีไฟล์) -->
    <div class="fab-stack hidden">
      <button id="addBtn" class="fab" title="Add PDFs">
        <svg viewBox="0 0 24 24" width="18" height="18"><path d="M12 5v14M5 12h14" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/></svg>
      </button>
      <button id="pickBtn" class="fab" title="Choose files">
        <svg viewBox="0 0 24 24" width="18" height="18"><path d="M4 7h10l3 3v7a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V7z" fill="none" stroke="currentColor" stroke-width="1.5"/><path d="M9 11h6M9 15h6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
      </button>
    </div>
    <button id="resetBtn" class="fab-right hidden" title="Reset">
      <svg viewBox="0 0 24 24" width="18" height="18"><path d="M4 4v6h6M20 20v-6h-6" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M20 10a8 8 0 0 0-14-4M4 14a8 8 0 0 0 14 4" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>
    </button>

    <!-- โหมดว่าง: กล่องอัปโหลด (อยู่กลาง) -->
    <section id="dropCard" class="card">
      <form class="uploader" onsubmit="return false;">
        <div id="dropzone" class="dropzone" tabindex="0">
          <div class="dz-text">
            <div class="dz-line"></div>
            <p>Drag &amp; Drop</p>
          </div>
          <input id="pdfInput" type="file" accept="application/pdf" hidden multiple>
          <button id="chooseBtn" class="btn-primary" type="button">Choose file PDF.</button>
        </div>
      </form>
    </section>

    <!-- โหมดมีไฟล์: กริด PDF -->
    <section id="gridSection" class="grid hidden" aria-live="polite"></section>

    <!-- CTA -->
    <button id="checkBtn" class="cta" disabled>Check Similarity</button>

    <!-- Modal Preview -->
    <div id="pdfModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal__backdrop" id="modalBackdrop"></div>
      <div class="modal__panel">
        <div class="modal__top">
          <div id="modalTitle" class="modal__title">Preview</div>
          <button id="modalClose" class="modal__close" aria-label="Close">×</button>
        </div>
        <div class="modal__body">
          <iframe id="pdfFrame" class="pdf-object" title="PDF preview"></iframe>
        </div>
      </div>
    </div>
  </main>

  <!-- ====== Scripts (วางท้าย body) ====== -->
  <!-- 1) PDF.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc =
      "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";
  </script>
  <!-- 2) โมดูลหลักของเรา -->
  <script type="module" src="{{ url_for('static', path='js/app.js') }}"></script>
</body>
</html>